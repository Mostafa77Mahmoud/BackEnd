ANALYSIS.PY STRUCTURE OUTLINE
===============================

File: app/routes/analysis.py
Total Lines: 862

IMPORTS & SETUP (Lines 1-29):
- Module imports
- Blueprint setup: analysis_bp = Blueprint('analysis', __name__)
- Temporary folder configuration

ENDPOINTS & FUNCTIONS:

1. @analysis_bp.route('/analyze', methods=['POST']) - Line 31
   Function: analyze_contract() - Lines 32-323
   Description: Analyze contract for Sharia compliance (file uploads or text input)

2. @analysis_bp.route('/analysis/<analysis_id>', methods=['GET']) - Line 324
   Function: get_analysis_results(analysis_id) - Lines 325-383
   Description: Retrieve analysis results by analysis ID

3. @analysis_bp.route('/session/<session_id>', methods=['GET']) - Line 384
   Function: get_session_details(session_id) - Lines 385-423
   Description: Fetch session details including contract info

4. @analysis_bp.route('/terms/<session_id>', methods=['GET']) - Line 424
   Function: get_session_terms(session_id) - Lines 425-456
   Description: Retrieve all terms for a session

5. @analysis_bp.route('/sessions', methods=['GET']) - Line 457
   Function: get_sessions() - Lines 458-490
   Description: List recent sessions with pagination

6. @analysis_bp.route('/history', methods=['GET']) - Line 491
   Function: get_analysis_history() - Lines 492-524
   Description: Retrieve analysis history

7. @analysis_bp.route('/statistics', methods=['GET']) - Line 525
   Function: get_statistics() - Lines 526-569
   Description: Provide system statistics

8. @analysis_bp.route('/stats/user', methods=['GET']) - Line 570
   Function: get_user_stats() - Lines 571-614
   Description: Provide user-specific statistics

9. @analysis_bp.route('/preview_contract/<session_id>/<contract_type>', methods=['GET']) - Line 615
   Function: preview_contract(session_id, contract_type) - Lines 616-711
   Description: Generate PDF previews of contracts

10. @analysis_bp.route('/download_pdf_preview/<session_id>/<contract_type>', methods=['GET']) - Line 712
    Function: download_pdf_preview(session_id, contract_type) - Lines 713-775
    Description: Proxy PDF downloads from Cloudinary

11. @analysis_bp.route('/feedback/expert', methods=['POST']) - Line 776
    Function: submit_expert_feedback() - Lines 777-855
    Description: Submit expert feedback on analysis

12. @analysis_bp.route('/health', methods=['GET']) - Line 856
    Function: health_check() - Lines 857-862
    Description: Health check endpoint

POTENTIAL HELPER FUNCTIONS TO EXTRACT:
- File processing utilities (used in analyze_contract)
- Text extraction and structuring
- Cloudinary upload helpers
- Database query patterns
- Error handling patterns